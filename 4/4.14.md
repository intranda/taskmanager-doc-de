# 4.14. Plugin: Plugin: Generierung von eBooks im Epub-Format

Das EPUB-Plugin generiert auf der Basis von ABBYY-XML-Dateien bzw. auch alternativ auf Basis von ALTO-Dateien sowie den zugehörigen METS-Dateien aus Goobi eBooks im epub-Format. Dabei werden Formatierungen, Tabellen und auch Bilder aus dem ABBYY-Format in das eBook übernommen.

## Aufruf des Plugins

Ein Beispiel-Aufruf des TaskClients lautet folgendermaßen:

```bash
java -jar TaskClient.jar -itm http://localhost:8080/itm/service 
    -e 
    -d {imagepath}  
    -gid {processid} 
    -n template.xml 
    -s {processpath}/ocr/{processtitle}_xml/ 
    -T {processtitle} 
    -t EPUB 
    -if {tifpath} 
    -mf {metaFile} 
    -amf {processpath}/meta_anchor.xml
```

## Parameter

Die innerhalb dieses Aufrufs zu übergebenen Parameter haben folgende Bedeutungen:

<table>
  <thead>
    <tr>
      <th style="text-align:left">Parameter</th>
      <th style="text-align:left">Mögliche Goobi Variable</th>
      <th style="text-align:left">Bedeutung</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align:left"><code>-itm</code>
      </td>
      <td style="text-align:left"><code>http://localhost/itm/service</code>
      </td>
      <td style="text-align:left">URL zur Schnittstelle des intranda TaskManagers</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-e</code>, <code>--returnError</code>
      </td>
      <td style="text-align:left">-</td>
      <td style="text-align:left">Wenn angegeben, beendet sich der TaskClient mit einem Fehlercode, um das
        automatische Fortschreiten im Workflow zu unterbinden</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-p</code>
      </td>
      <td style="text-align:left"><code>0 &#x2013; 10</code>
      </td>
      <td style="text-align:left">Priorität zur Verarbeitung dieses Jobs</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-gid</code>
      </td>
      <td style="text-align:left"><code>{processid}</code>
      </td>
      <td style="text-align:left">ID des Goobi-Vorgangs</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-i</code>
      </td>
      <td style="text-align:left"><code>{stepid}</code>
      </td>
      <td style="text-align:left">Die ID des Arbeitsschrittes, der den Aufruf startet</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-T</code>, <code>--title</code>
      </td>
      <td style="text-align:left"><code>{processtitle}</code>
      </td>
      <td style="text-align:left">Der Vorgangstitel in Goobi, für den der Aufruf gestartet wird</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-t</code>, <code>--jobtype</code>
      </td>
      <td style="text-align:left"><code>EPUB</code>
      </td>
      <td style="text-align:left">Der Typ des Jobs</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-n</code>, <code>--templatename</code>
      </td>
      <td style="text-align:left"><code>template.xml</code>
      </td>
      <td style="text-align:left">Dieser Parameter wird vom Plugin nicht verwendet.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-s</code>, <code>--source</code>
      </td>
      <td style="text-align:left">
        <p><code>{processpath}/ocr/</code>
        </p>
        <p><code>{processtitle}\_xml/</code>
        </p>
      </td>
      <td style="text-align:left">Der Pfad zum Ordner der ABBYY-XML-Dateien</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-d</code>, <code>--destination</code>
      </td>
      <td style="text-align:left"><code>{imagepath}</code>
      </td>
      <td style="text-align:left">Der Pfad zum Ordner, in dem das eBook gespeichert werden soll</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-if</code>
      </td>
      <td style="text-align:left"><code>{tifpath}</code>
      </td>
      <td style="text-align:left">Pfad zu den Bildern, die für die Texterkennung durch Abbyy zuvor verwendet
        wurden</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-mf</code>
      </td>
      <td style="text-align:left"><code>{metaFile}</code>
      </td>
      <td style="text-align:left">Pfad zu der METS-Datei innerhalb von Goobi</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-amf</code>
      </td>
      <td style="text-align:left">
        <p><code>{processpath}/</code>
        </p>
        <p><code>meta_anchor.xml</code>
        </p>
      </td>
      <td style="text-align:left">Pfad zu der METS-Datei des Anchors innerhalb von Goobi. Dieser Parameter
        ist nur für Periodika relevant.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-loc</code>
      </td>
      <td style="text-align:left"><code>de</code>
      </td>
      <td style="text-align:left">Optionaler Parameter für die Angabe einer Sprachvariante zur Erzeugung
        von Bezeichnungen wie dem Titel des Inhaltsverzeichnis. Ist keine Sprache
        angegeben, wird als Sprache englisch (en) angenommen.</td>
    </tr>
    <tr>
      <td style="text-align:left"><code>-rtl</code>
      </td>
      <td style="text-align:left"><code>true</code> / <code>false</code>
      </td>
      <td style="text-align:left">Optionaler Parameter der festlegt, ob es sich bei dem Werk um ein Buch
        handelt, was von rechts nach links zu verarbeiten ist (z.B. hebräische
        Werke). Fehlt dieser Parameter, wird von einem Buch ausgegangen, das von
        links nach rechts zu verarbeiten ist.</td>
    </tr>
  </tbody>
</table>## Konfiguration des Plugins

Die Konfiguration der eBook-Generierung erfolgt unter folgendem Pfad:

```bash
/opt/digiverso/itm/plugins/config/epubconfig.xml
```

Beispielhaft sieht eine solche Konfigurationsdatei folgendermaßen aus:

```markup
<epubConfig>
 <tempPath>/tmp/</tempPath>
 <jobsInProcessing max="5"/>
</epubConfig>
```

